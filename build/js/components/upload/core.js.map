{"version":3,"sources":["../../../../src/js/components/upload/core.js"],"names":["define","data","helper","method","model","$","init","element","context","options","local","_options","bind","$this","val","_prototype","upload","apply","concat","Array","prototype","slice","call","arguments","file","files","info","name","size","type","split","length","exts","txt","img","doc","flag","spread","dest","s3","inArray","Object","keys","toUpperCase","idx","form","FormData","append","isBtn","siblings","text","addClass","removeClass","beforeStart","extensions","item","ajax","url","contentType","processData","mimeType","dataType","timeout","complete","success","status","xhr","result","code","remove","before","msg","toast","error","jQuery"],"mappings":"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","file":"core.js","sourcesContent":["define([\r\n    '../../core/utils/data',\r\n    '../../core/utils/helper',\r\n    '../../core/utils/method',\r\n    '../../core/models/index'\r\n], (data, helper, method, model) => {\r\n    (function($) {\r\n        new method('upload', {\r\n            init: function (element) {\r\n                var context = this;\r\n                var options = context.local._options;\r\n\r\n                element.bind('change', function() {\r\n                    var $this = $(this);\r\n\r\n                    if ($this.val() !== '') {\r\n                        context.local._prototype.upload.apply(context, [].concat($this, options, Array.prototype.slice.call(arguments, 2)));\r\n                    }\r\n                });\r\n            },\r\n            method: {\r\n                upload: function (element, options) {\r\n                    var context = this;\r\n\r\n                    var file = element[0].files[0];\r\n                    var info = {\r\n                        name: file.name,\r\n                        size: file.size,\r\n                        type: (file.type.split('/'))[(file.type.split('/')).length - 1],\r\n                        exts: (file.name.split('.'))[(file.name.split('.')).length - 1],\r\n                    };\r\n                    var exts = {\r\n                        txt: ['TXT', 'LOG'],\r\n                        img: ['JPEG', 'JPG', 'JPE', 'PJPEG', 'PNG', 'GIF', 'BMP', 'RAW'],\r\n                        doc: ['DOC', 'DOCX', 'PPT', 'PPTX', 'HWP', 'XLS', 'XLSX', 'PDF', 'CSV'],\r\n                        flag: {\r\n                            txt: 'Text',\r\n                            img: 'Image',\r\n                            doc: 'Doc',\r\n                            spread: 'Spread'\r\n                        },\r\n                        dest: {\r\n                            local: 'Local',\r\n                            s3: 'AWSS3'\r\n                        }\r\n                    };\r\n\r\n                    if (typeof options.type !== 'undefined' && options.type !== null) {\r\n                        if ($.inArray(options.type, Object.keys(exts)) !== -1) {\r\n                            if ($.inArray(info.type.toUpperCase(), exts[options.type]) !== -1) {\r\n                                var idx = null;\r\n                                if($.inArray(info.exts.toUpperCase(), exts[options.type]) !== -1) {\r\n                                    var form = new FormData();\r\n                                    form.append('file', file, file.name);\r\n                                    if (typeof options.type !== 'undefined' && options.type !== null) {\r\n                                        form.append('type', exts.flag[options.type]);\r\n                                    }\r\n\r\n                                    if (typeof options.dest !== 'undefined' && options.dest !== null) {\r\n                                        form.append('dest', exts.dest[options.dest]);\r\n                                    }\r\n\r\n                                    if (typeof options.data !== 'undefined') {\r\n                                        for (idx in options.data) {\r\n                                            form.append(idx, options.data[idx]);\r\n                                        }\r\n                                    }\r\n\r\n                                    if (typeof options.isBtn !== 'undefined' && options.isBtn === true) {\r\n                                        element\r\n                                            .siblings('.btn')\r\n                                            .text('업로드 중')\r\n                                            .addClass('btn-default')\r\n                                            .removeClass('btn-success btn-danger');\r\n                                    }\r\n\r\n                                    if (typeof options.beforeStart === 'function') {\r\n                                        options.beforeStart.apply(element, Array.prototype.slice.call(arguments));\r\n                                    }\r\n\r\n                                    if (typeof options.extensions !== 'undefined') {\r\n                                        for (idx in options.extensions) {\r\n                                            var item = options.extensions[idx];\r\n                                            form.append(idx, item);\r\n                                        }\r\n                                    }\r\n\r\n                                    $.ajax({\r\n                                        url: options.url,\r\n                                        data: form,\r\n                                        type: 'POST',\r\n                                        contentType: false,\r\n                                        processData: false,\r\n                                        mimeType: 'multipart/form-data',\r\n                                        dataType: 'json',\r\n                                        timeout: 30000,\r\n                                        complete: options.complete,\r\n                                        success: function (data, status, xhr) {\r\n                                            var result = data.data;\r\n\r\n                                            if (data.code === 200) {\r\n                                                element.val('');\r\n\r\n                                                if (options.type === 'img') {\r\n                                                    if (typeof options.isBtn !== 'undefined' && options.isBtn === true) {\r\n                                                        element.siblings('.btn, img').remove();\r\n                                                        element.before('<img src=\"' + result.data + '\" />');\r\n                                                    }\r\n                                                } else {\r\n                                                    if (typeof options.isBtn !== 'undefined' && options.isBtn === true) {\r\n                                                        element.siblings('.btn').text('완료').removeClass('btn-default btn-danger').addClass('btn-success');\r\n                                                    }\r\n                                                }\r\n\r\n                                                element.data('value', result.data);\r\n\r\n                                                if (typeof options.success === 'function') {\r\n                                                    options.success.apply(element, Array.prototype.slice.call(arguments));\r\n                                                }\r\n                                            } else {\r\n                                                if (typeof result.msg !== 'undefined') {\r\n                                                    toast(result.msg);\r\n                                                }\r\n                                            }\r\n                                        },\r\n                                        error: function (xhr, status, error) {\r\n                                            toast('Unexpected error are occured when uploading.');\r\n                                            if (typeof options.isBtn !== 'undefined' && options.isBtn === true) {\r\n                                                element.siblings('.btn')\r\n                                                        .text('Error')\r\n                                                        .removeClass('btn-default btn-success')\r\n                                                        .addClass('btn-danger');\r\n                                            }\r\n                                            if (typeof options.error === 'function') {\r\n                                                options.error.apply(element, Array.prototype.slice.call(arguments));\r\n                                            }\r\n                                        }\r\n                                    });\r\n                                } else {\r\n                                    toast('.' + info.exts + '은 업로드를 지원하는 확장자가 아닙니다.');\r\n                                }\r\n                            } else {\r\n                                toast('.' + info.exts + '은 업로드를 지원하는 확장자가 아닙니다.');\r\n                            }\r\n                        } else {\r\n                            toast(options.type + '은 허용하는 확장자 옵션 정의가 아닙니다.');\r\n                        }\r\n                    } else {\r\n                        // Write some codes here.\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }(jQuery));\r\n});"]}