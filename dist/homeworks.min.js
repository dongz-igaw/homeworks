//================================================================================
// [homeworks-framework]
// version: 0.0.1
// update: 2016.02.22
//================================================================================

!function(){var a={},b={},c={};String.prototype.getFormat=function(a){var b=this;for(var c in a){var d=a[c];c=c.replace(/\\/gi,"\\\\").replace(/-/gi,"\\-");var e=new RegExp("{"+c+"}","gi");b=b.replace(e,d)}return b.toString()},Function.prototype.hook=function(a,b){try{var c="[data-{data-name}]",d=this;$(c.getFormat({"data-name":a})).each(function(){var c=$(this),e=c.data("pen"),f=c.data(a);return f===!1?!0:void("function"==typeof d&&("undefined"==typeof e?d.call(c,null,f,b):d.call(c,$(e),f,b)))})}catch(e){console.warn(e)}},function(d){function e(a,b){this.preference={$self:this,$super:a,$helper:null,_anim:!1,_bind:!1,_debug:!0,_init:!1,anim:{time:300,effect:"swing"},framework:"homeworks",prefix:"works",id:"",o:{$w:d(window),$d:d(document)},p:{},i:{_init:!1},g:{}},this.preference.id=b,this.preference.g=c[b],this.preference.$helper=new f(a)}function f(a){var c=a;this.promise=function(a,d,e){return"function"==typeof a&&"number"==typeof d&&(e=d,d=a,a=c.data.id),b[c.data.framework+"."+a]=setTimeout(function(){try{delete b[c.data.framework+"."+a]}catch(e){c.data.$helper.log(e)}"function"==typeof d&&d()},e),b},this.invoke=function(a){if("undefined"!=typeof b[c.data.framework+"."+a])try{clearTimeout(b[c.data.framework+"."+a]),delete b[c.data.framework+"."+a]}catch(d){return!1}return!0},this.log=function(a,b){if(c.data._debug===!0){var d=a;"undefined"!=typeof b&&null!==b&&(d="["+b+"] "+d),console.warn(d)}},this.parseTemplate=function(a,b){var d=c.template[a];return"undefined"==typeof d?(c.data.$helper.log("'"+a+"' 이름의 템플릿이 확인되지 않습니다."),!1):d.getFormat(b)},this.bind=function(a,b,d,e){try{var f=b.toString().split(" ");for(var g in f)f[g]=f[g]+"."+c.data.framework+"."+c.data.id;f=f.join(" "),a.bind(f,d),"undefined"!=typeof e&&e===!0&&this.triggerHandler(a,b)}catch(h){c.data.$helper.log(a)}},this.unbind=function(a,b){a.unbind(b+"."+c.data.framework+"."+c.data.id)},this.trigger=function(a,b){a.trigger(b+"."+c.data.framework+"."+c.data.id)},this.triggerHandler=function(a,b){var d=b.toString().split(" ")[0];a.triggerHandler(d+"."+c.data.framework+"."+c.data.id)}}function g(a,b){var f=this;if(this.init=b.init,this.method={init:this.init},this.template={},d.extend(this.method,b.method),d.extend(this.template,b.template),this.route=function(){var a=this,b=[];arguments.length>0&&d.map(arguments,function(a,c){b.push(a)});var c=function(){if("object"==typeof this&&("undefined"==typeof this.data&&(this.data={}),"undefined"==typeof this.data[f.data.id]&&(this.data[f.data.id]={},d.extend(this.data[f.data.id],f.method),f.data.i=this.data[f.data.id])),0===b.length||"object"==typeof b[0])return"object"==typeof b[0]&&(f.data.i=this.data[f.data.id],d.extend(f.data.i,b[0]),this.data[f.data.id]=f.data.i),"undefined"==typeof this.data[f.data.id]._init||this.data[f.data.id]._init===!1?(this.data[f.data.id]._init=!0,f.data.i=this.data[f.data.id],f.init.apply(f,[d(this)].concat(Array.prototype.slice.call(b)))):f;if("string"==typeof b[0])try{return("undefined"==typeof this.data[f.data.id]._init||this.data[f.data.id]._init===!1)&&(this.data[f.data.id]._init=!0,f.data.i=this.data[f.data.id],"undefined"!=typeof f.method.init?f.method.init.apply(f,[d(this)].concat(Array.prototype.slice.call(b))):f.init.apply(f,[d(this)].concat(Array.prototype.slice.call(b)))),f.method[b[0]].apply(f,[d(this)].concat(Array.prototype.slice.call(b,1)))}catch(a){console.warn(a)}else f.data.$helper.log("파라미터 유효성 경고")};b.length>0&&a==f.data.o.$w[0]?f.method.init.apply(f,Array.prototype.slice.call(b)):a.each(c)},"undefined"!=typeof b.options&&null!==b.options&&"undefined"==typeof c[a]&&(c[a]=b.options),"undefined"==typeof this.data&&(this.data=new e(this,a.replace(/[^\w]/gi,"")).preference),this.data._bind===!1){this.data._bind=!0,a=a.split(",");for(var g in a){var h=d.trim(a[g]);d.fn[h]=this.route,window[h]=this.route}}}a.modal=new g("modal, popup",{init:function(a,b){var c=this,e=a.find(".btn-close");this.data._visible=!1,a.hasClass("modal-full")||this.data.$helper.bind(this.data.o.$w,"resize",function(){a.css({left:(c.data.o.$w.width()-a.width())/2,top:(c.data.o.$w.height()-a.height())/2})},!0),this.data.$helper.bind(e,"click",function(b){b.preventDefault(),b.stopPropagation();d(this);a[0].data[c.data.id].close.call(c,a)}),e.ripple()},method:{toggle:function(a){console.log(a[0].data[this.data.id]),this.data._visible===!0?a[0].data[this.data.id].close.call(this,a):a[0].data[this.data.id].open.call(this,a)},open:function(a){a.hasClass("modal-full")?a.css({display:"table"}):a.show(),a.triggerHandler("modal.open"),this.data._visible=!0},close:function(a){a.hide(),a.triggerHandler("modal.close"),this.data._visible=!1}},template:{overlay:'<div class="{framework}-{id}"></div>'}}),a.ripple=new g("ripple",{init:function(a,b){var c=this;return a.each(function(){var a=d(this);a.addClass("btn-ripple"),-1!=d.inArray(c.data.i.theme,c.data.g.supportThemes)&&a.addClass("btn-ripple-"+c.data.i.theme),c.data.$helper.bind(a,"click",function(b){var e=d(this);e.hasClass(".btn-ripple")||(a.addClass("btn-ripple"),-1!=d.inArray(a[0].data[c.data.id].theme,c.data.g.supportThemes)&&a.addClass("btn-ripple-"+a[0].data[c.data.id].theme));var f=d(c.data.$helper.parseTemplate("effect")),g=Math.min(e.width(),e.height()),h=Math.max(e.width(),e.height())/g*2,i={x:b.clientX-e.offset().left-g/2,y:b.clientY-e.offset().top-g/2};f.css({width:g,height:g,left:i.x,top:i.y}),f.appendTo(e),c.data.$helper.promise(function(){c.data.$helper.promise(function(){c.data.$helper.promise(function(){f.remove()},500),f.addClass("anim-end").css({opacity:0})},150),f.css({transform:"scale("+h+")",opacity:1})},50)})})},method:{},template:{effect:'<div class="btn-ripple-effect"></div>'},options:{supportThemes:["light","dark"]}}),a.tooltip=new g("tooltip",{init:function(a,b){var c=this,e={type:"toggle",margin:20,direction:"left"};d.extend(e,b),a.each(function(){var a=d(this);""===a.data("title")&&a.data("title",a.attr("title")||""),(null===e.type||""===e.type||-1===d.inArray(e.type,c.data.g.supportThemes))&&(e.type="show");var b=d(c.data.$helper.parseTemplate("tooltip",{content:a.data("title")}));""!==a.data("header")&&b.find(".works-tooltip-header").remove();var f={top:a.offset().top,left:a.offset().left};b.appendTo("body"),"left"==e.direction?f.left-=b.outerWidth()+e.margin:"top"==e.direction?f.top-=b.outerHeight()+e.margin:"right"==e.direction?f.left+=a.width()+e.margin:"bottom"==e.direction&&(f.top+=a.height()+e.margin),b.css({left:f.left,top:f.top}),"show"==e.type||"queue"==e.type})},method:{show:function(){$tooltip.addClass("active"),_this.data.$helper.promise(function(){$tooltip.addClass("animate-in")},25)},queue:function(){}},template:{tooltip:'<div class="works-tooltip"><div class="works-tooltip-header">{title}</div><div class="works-tooltip-body">{content}</div><span class="works-tooltip-arrow"></span></div>'},options:{supportTypes:["toogle","show","hide"]}}),a.input=new g("input",{init:function(a,b){var c=this,e=[37,38,39,40,9,13,17,46],f=!1,g=null;a.each(function(){var a=d(this);a.hasClass("input-number")?c.data.$helper.bind(a,"keydown keyup",function(a){setTimeout(function(){if("keyup"==a.type&&17==a.keyCode){f=!0;try{clearTimeout(g)}catch(b){}setTimeout(function(){f=!1},150)}if(-1==d.inArray(a.keyCode,e)&&("undefined"==typeof a.ctrlKey||a.ctrlKey===!1)&&f===!1){var c=0,h=b[0].value.length;if(b[0].selectionStart||"0"==b[0].selectionStart)c=b[0].selectionStart;else{var i=document.selection.createRange();i.moveStart("character",-b[0].value.length),c=i.text.length}var j=b.val();"undefined"!=typeof j&&null!==j&&(j=j.toString().split(".")[0]),j=j.toString().replace(/[^\d]*/gi,"").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"),b.val(j);var k=Math.max(0,j.length-h);if(c+=k,b[0].selectionStart||"0"==b[0].selectionStart)b[0].setSelectionRange(c,c);else if("undefined"!=b[0].createTextRange){var l=b[0].createTextRange();l.move("character",c),l.select()}a.isTrigger||b.triggerHandler("change")}},25)},!0):a.hasClass("input-datetime")||a.hasClass("input-decimal")})}}),a.toast=new g("toast",{init:function(a,b){},method:{init:function(a){var b=this;if("undefined"==typeof a)return!1;"object"==typeof a&&(a=JSON.stringify(a));var c=d(".toast-box");c.length<=0&&(c=d(b.data.$helper.parseTemplate("toastBox")),c.appendTo("body"),c.css({marginLeft:-c.width()/2}));var e=d(b.data.$helper.parseTemplate("toast",{msg:a})),f=d(e.clone()).add("<br />");e.addClass("toast-empty"),e.appendTo(".toast-box"),f.addClass("toast-real");var g=e.height();e.addClass("toast-anim"),setTimeout(function(){e.addClass("toast-anim-start").stop().animate({paddingTop:"1em",paddingBottom:"1em",marginBottom:"1em"},300,"easeInOutQuad"),e.height(g),setTimeout(function(){e.remove(),f.appendTo(".toast-box"),setTimeout(function(){f.addClass("toast-anim-start");var b=Math.min(Math.max(50*a.length,1500),5e3);setTimeout(function(){f.removeClass("toast-anim-start"),setTimeout(function(){f.remove()},300)},b)},25)},300)},25)}},template:{toast:'<div class="toast">{msg}</div>',toastBox:'<div class="toast-box"></div>'}}),a.fileupload=new g("fileupload",{init:function(a,b){var c=this;d(a).bind("change",function(){var a=d(this);""!==a.val()&&c.method.upload.apply(c,[].concat(a,b,Array.prototype.slice.call(arguments,2)))})},method:{upload:function(a,b){var c=a[0].files[0],e={name:c.name,size:c.size,type:c.type.split("/")[c.type.split("/").length-1],exts:c.name.split(".")[c.name.split(".").length-1]},f={txt:["TXT","LOG"],img:["JPEG","JPG","JPE","PJPEG","PNG","GIF","BMP","RAW"],doc:["DOC","DOCX","PPT","PPTX","HWP","XLS","XLSX","PDF","CSV"],flag:{txt:"T",img:"I",doc:"D",spread:"S"}};if("undefined"!=typeof b&&"undefined"!=typeof b.type&&null!==b.type)if(-1!=d.inArray(b.type,Object.keys(f)))if(-1!=d.inArray(e.type.toUpperCase(),f[b.type]))if(-1!=d.inArray(e.exts.toUpperCase(),f[b.type])){var g=new FormData;if(g.append("file",c,c.name),"undefined"!=typeof b.type&&null!==b.type&&g.append("type",f.flag[b.type]),"undefined"!=typeof b.data)for(var h in b.data)g.append(h,b.data[h]);a.siblings(".btn").text("업로드 중").addClass("btn-default").removeClass("btn-success btn-danger"),d.ajax({url:b.url,data:g,type:"POST",contentType:!1,processData:!1,mimeType:"multipart/form-data",dataType:"json",timeout:3e4,complete:b.complete,success:function(c,d,e){if(200==c.code){var f=c.data;a.val(""),"img"==b.type?(a.siblings(".btn, img").remove(),a.before('<img src="'+f.data+'" />')):a.siblings(".btn").text("완료").removeClass("btn-default btn-danger").addClass("btn-success"),a.data("value",c.data),"function"==typeof b.success&&b.success.apply(this,Array.prototype.slice.call(arguments))}else"undefined"!=typeof c.data.msg&&alert(c.data.msg)},error:function(a,c,d){alert("업로드 요청 도중 에러가 발생했습니다.\r\n잠시 후 다시 시도해주세요."),d.siblings(".btn").text("에러").removeClass("btn-default btn-success").addClass("btn-danger"),"function"==typeof b.error&&b.error.apply(this,Array.prototype.slice.call(arguments))}})}else alert("."+e.exts+"은 업로드를 지원하는 확장자가 아닙니다.");else alert("."+e.exts+"은 업로드를 지원하는 확장자가 아닙니다.");else alert(b.type+"은 허용하는 확장자 옵션 정의가 아닙니다.")}}})}(jQuery),$(function(){(function(a,b){this.ripple({theme:b})}).hook("ripple"),function(a,b){var c=$(document),d=$(".works-wrapper"),e=$(".works-sider");e.bind("click",function(a){a.stopPropagation()}),this.bind("click",function(a){a.stopPropagation();$(this);e.hasClass("works-sider-active")?(e.removeClass("works-sider-active"),d.removeClass("works-sider-active"),c.unbind("click.worksMenuHandler")):(e.addClass("works-sider-active"),d.addClass("works-sider-active"),c.unbind("click.worksMenuHandler").bind("click.worksMenuHandler",function(a){a.preventDefault(),e.removeClass("works-sider-active"),d.removeClass("works-sider-active"),c.unbind("click.worksMenuHandler")}))})}.hook("menu"),function(a){this.bind("click",function(b){b.preventDefault(),a.modal("toggle")})}.hook("modal"),function(a,b){this.tooltip({type:b})}.hook("tooltip")})}();